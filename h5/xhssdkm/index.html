<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1,
      maximum-scale=1, user-scalable=no"> -->
    <meta name="viewport" content="width=750,user-scalable=no" />
    <title>唱响新时代英雄赞歌</title>
    <script src="//cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <script src="//res.wx.qq.com/open/js/jweixin-1.0.0.js" type="text/javascript" charset="utf-8"></script>
  </head>

  <body>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>

  <script>
  function is_weixn() {
    var ua = navigator.userAgent.toLowerCase();
    if (ua.match(/MicroMessenger/i) == "micromessenger") {
      return true;
    } else {
      return false;
    }
  }

  function isIOS(){
    return /(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)
  }

  function isAndroid(){
    return /(Android)/i.test(navigator.userAgent)
  }


  var audio = document.getElementById("bgMusic")

  $(function () {
    if(is_weixn()){
      // 微信自动播放
      if (window.WeixinJSBridge) {
        WeixinJSBridge.invoke('getNetworkType', {}, function (e) {
          audio.muted = true
          audio.play();
          window.canplay=true;
          console.log('getNetworkType canplay'+canplay)
        }, false);
      }
      document.addEventListener("WeixinJSBridgeReady", function () {
        WeixinJSBridge.invoke('getNetworkType', {}, function (e) {
          audio.muted = true
          audio.play();
          window.canplay=true;
          console.log('getNetworkType canplay'+canplay)
        });
      }, false);

      function autoPlayAudio() {
        if (wx) {
          wx.config({
            // 配置信息, 即使不正确也能使用 wx.ready
            debug: false,
            appId: '',
            timestamp: 1,
            nonceStr: '',
            signature: '',
            jsApiList: []
          });
          wx.ready(function () {
            audio.muted = true
            audio.play();
            window.canplay=true;
            console.log('getNetworkType canplay'+canplay)
          });
        }
      };
      // 解决ios音乐不自动播放的问题
      autoPlayAudio();
    }else if(isIOS()||isAndroid()){
      audio.muted = true
      audio.autoplay="autoplay"
      $("#app").one("click", function () {
        console.log('app one click')
        
        audio.play();
        window.canplay=true;
        console.log('getNetworkType canplay'+canplay)
      });
    }
    // else {
    //   audio.autoplay="autoplay"
    //   audio.muted = true
    //   window.canplay=true;
    // }
  });




</script>
</html>